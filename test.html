<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>Nutrient Contents - Parallel Coordinates</title>

<script type="text/javascript" src="js/d3.v2.js"></script>
<script type="text/javascript" src="js/parallel-coordinates-veggie.js"></script>

<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/underscore.js"></script>
<script type="text/javascript" src="js/backbone.js"></script>

<script src="js/jquery-ui-1.8.16.custom.min.js"></script>
<script type="text/javascript" src="js/filter.js"></script>

<!-- SlickGrid -->
<link rel="stylesheet" href="css/slick.grid.css" type="text/css" media="screen" charset="utf-8">
<link rel="stylesheet" href="css/slick.grid.override.css" type="text/css" media="screen" charset="utf-8">
<script src="js/jquery.event.drag-2.0.min.js"></script>
<script src="js/slick.core.js"></script>
<script src="js/slick.grid.js"></script>
<script src="js/slick.dataview.js"></script>
<script src="js/slick.pager.js"></script>
<script src="js/grid.js"></script>
<script src="js/options.js"></script>
<script src="js/data-table.js"></script>
<!-- bootstrap -->
<script src="js/bootstrap.min.js"></script>
<link href="css/bootstrap.min.css" rel="stylesheet" media="screen">

<link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8">

<link rel="stylesheet" href="css/svg.css" type="text/css" charset="utf-8">
</head>

<body>

  <div class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
      
      <div class="brand">
        &nbsp; Exploring Peer Evaluation on Venture-Lab
      </div>
      <ul class="nav pull-right">
        
        <!-- <li>
          <a href="#"  data-toggle="collapse" data-target="#control-wrapper">
            Show/Hide Column Filter
            
          </a>
        </li> -->
        <li><a href="#about">About</a></li>
      </ul> 
    </div>
  </div>
  <div class="well">
    <div id="control" class="collapse in"></div>
  </div>
  <div id="parallel-wrapper">
    <div id="control-wrapper">
      
    </div>

  
    <div id="parallel" class="ui-resizable"></div>
  </div>
  <a href="#" id="keep_selected" class="button green filter_control"> Keep </a>
  <a href="#" id="reset_selected" class="button green filter_control"> Reset </a>
  <input class="typeahead" type="text" onkeydown="search()" data-provide="typeahead">
  <div id="myGrid"> </div>
</body>

<script type="text/javascript">
  function search() {
      console.log("search");
  }
  $(function() {
    var dimensions = new Filter();
    var highlighter = new Selector();

    dimensions.set({data: reviewdata });
    
    var dimensionType={
        age_range: "ordinal",
        location: "ordinal",
        gender: "ordinal",
        team_id: "ordinal",
        user_id: "ordinal"
      };

    var columns = _(reviewdata[0]).keys();
    var axes = _(columns).without('name', 'group');
    var pc = parallel(dimensions,dimensionType);
    var slicky = new grid({
      model: dimensions,
      selector: highlighter,
      width: $('body').width(),
      columns: columns
    });

    parallel_height = 500;
    $('#parallel').css({
        height: parallel_height + 'px',
        width: $(window).width() + 'px'
    });
    
    slicky.update();
    pc.render();

    highlighter.bind('change:selected', function() {
      console.log("selected");
      var highlighted = this.get('selected');
      console.log(highlighted);
      pc.highlight(highlighted);
    });

    $('#keep_selected').click(function() {
      dimensions.inliers();
      pc.update(dimensions.get('data'));
      pc.render();
      dimensions.trigger('change:filtered');
      return false;
    });

    $('#reset_selected').click(function() {
      dimensions.set({data: reviewdata});
      dimensions.clearFilter();
      pc.update(dimensions.get('data'));
      pc.render();
      dimensions.trigger('change:filtered');
      return false;
    });
    var user_ids = _.uniq(_(reviewdata).map(function(d) {
         return "" + d["user_id"]; 
      }));
    console.log(user_ids);
    $('.typeahead').typeahead({source : user_ids});

  });
</script>
</body></html>
